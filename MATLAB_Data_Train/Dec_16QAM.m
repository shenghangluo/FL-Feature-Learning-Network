function [E_out] = Dec_16QAM(E_in)

E_in=E_in*sqrt(10);

xi = real(E_in);
xq = imag(E_in);

E_out=3*(xi>=2)+1j*3*(xq>=2)...
   +3*(xi>=2)+1j*1*(xq<2&xq>=0)...
   +3*(xi>=2)-1j*1*(xq>-2&xq<0)...
   +3*(xi>=2)-1j*3*(xq<=-2)...
   +1*(xi<2&xi>=0)+1j*3*(xq>=2)...
   +1*(xi<2&xi>=0)+1j*1*(xq<2&xq>=0)...
   +1*(xi<2&xi>=0)-1j*1*(xq>-2&xq<0)...
   +1*(xi<2&xi>=0)-1j*3*(xq<=-2)...
   -1*(xi>-2&xi<0)+1j*3*(xq>=2)...
   -1*(xi>-2&xi<0)+1j*1*(xq<2&xq>=0)...
   -1*(xi>-2&xi<0)-1j*1*(xq>-2&xq<0)...
   -1*(xi>-2&xi<0)-1j*3*(xq<=-2)...
   -3*(xi<=-2)+1j*3*(xq>=2)...
   -3*(xi<=-2)+1j*1*(xq<2&xq>=0)...
   -3*(xi<=-2)-1j*1*(xq>-2&xq<0)...
   -3*(xi<=-2)-1j*3*(xq<=-2);
% E2=3*(xi>=2)+1j*1*(xq<2&xq>=0);
% E3=3*(xi>=2)-1j*1*(xq>-2&xq<0);
% E4=3*(xi>=2)-1j*3*(xq<=-2);

% E5=1*(xi<2&xi>=0)+1j*3*(xq>=2);
% E6=1*(xi<2&xi>=0)+1j*1*(xq<2&xq>=0);
% E7=1*(xi<2&xi>=0)-1j*1*(xq>-2&xq<0);
% E8=1*(xi<2&xi>=0)-1j*3*(xq<=-2);

% E9=-1*(xi>-2&xi<0)+1j*3*(xq>=2);
% E10=-1*(xi>-2&xi<0)+1j*1*(xq<2&xq>=0);
% E11=-1*(xi>-2&xi<0)-1j*1*(xq>-2&xq<0);
% E12=-1*(xi>-2&xi<0)-1j*3*(xq<=-2);

% E13=-3*(xi<=-2)+1j*3*(xq>=2);
% E14=-3*(xi<=-2)+1j*1*(xq<2&xq>=0);
% E15=-3*(xi<=-2)-1j*1*(xq>-2&xq<0);
% E16=-3*(xi<=-2)-1j*3*(xq<=-2);


% E_out = E1+E2+E3+E4+E5+E6+E7+E8+E9+E10+E11+E12+E13+E14+E15+E16;
E_out=E_out/4;

E_out=E_out/sqrt(10);

end